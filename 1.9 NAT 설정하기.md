# 1.9 NAT 설정하기
부하 분산 장치의 백 엔드 풀에 연결되는 가상 컴퓨터에는 공용 IP가 **할당되지 않아도 접근이 가능**합니다. 하지만 이렇게 설정할 시 외부에서 가상 컴퓨터에 연결을 할 수 없기 때문에 부하 분산 장치에서는 백 엔드 풀에 연결되어 있는 가상컴퓨터와 통신이 가능하도록 NAT 설정을 할 수 있습니다.

이번 내용에서는 부하 분산 장치의 백 엔드 풀에 연결되어 있는 가상 컴퓨터에 Port 22를 NAT 설정하여 부하 분산 장치의 공용 IP로 가상 컴퓨터에 SSH 접근을 해 보도록 하겠습니다.

> [!메모]
>
> 이번 내용에서는 Azure cli 2.0을 사용하는 시나리오가 없습니다.

## 웹 콘솔에서 Azure 부하 분산 장치에 NAT 설정하기
1. [Azure 웹 콘솔 (https://portal.azure.com)](https://portal.azure.com)에 접속합니다.

2. 좌측 메뉴에서 **부하 분산 장치**를 선택합니다.
    - 좌측 메뉴에 **부하 분산 장치**가 없다면, 하단의 More Service를 선택 한 후 **네트워킹** 부분에서 **부하 분산 장치**를 찾아 선택합니다.

3. **부하 분산 장치** 블레이드 창이 뜨면 왼쪽 메뉴에서 **인바운드 NAT 규칙**을 클릭하고 상단에 **추가**버튼을 클릭합니다.

4. **인바운드 NAT 규칙 추가** 블레이드 창이 뜨면 아래와 같이 입력한 후 하단에 **확인**버튼을 클릭하여 **인바운드 NAT 규칙**을 추가합니다.
    - `이름`: 표시 될 인바운드 NAT 규칙의 이름
    - `프런트 엔드 IP 주소`: NAT 규칙으로 접근 가능하게 설정 될 **프런트 엔드 IP 주소**를 선택합니다. 여기서는 기본 값을 그대로 두겠습니다.
    - `IP 버전`: **부하 분산 장치**의 기본 값을 따라갑니다. 선택이 불가능 합니다.
    - `서비스`: NAT 규칙을 선택합니다. **사용자 지정**을 선택하면 `프로토콜`과 `포트`를 직접 입력하실 수 있습니다. 여기서는 **SSH**를 찾아 선택하도록 하겠습니다.
    - `프로토콜`: NAT 할 프로토콜을 선택합니다. `서비스`에서 지정했기 때문에 현재 설정을 그대로 둡니다.
    - `포트`: NAT 할 포트를 입력합니다. `서비스`에서 지정했기 때문에 현재 설정을 그대로 둡니다.
    - `다음에 연결됨`: NAT를 연결 할 위치를 나타냅니다. 여기서는 기본 값을 그대로 둡니다.
    - `대상 가상 컴퓨터`: NAT를 연결 할 **가상 컴퓨터**를 선택합니다. 클릭하여 선택할 수 있는 **가상 컴퓨터**를 선택합니다.
    - `네트워크 IP 구성`: NAT를 연결 할 **가상 컴퓨터**의 **네트워크 인터페이스**를 선택합니다. 클릭하여 선택할 수 있는 **네트워크 인터페이스**를 선택합니다.
    - `포트 매핑`: NAT 매핑을 정의합니다. **기본값**으로 설정하면 위의 `프로토콜`과 `포트`에서 설정한 값이 그대로 적용됩니다. **사용자 지정**을 선택할 시 포트포워딩 설정이 가능합니다. 여기서는 **기본값**을 선택하겠습니다.

5. 업데이트가 완료되면 **부하 분산 장치** 블레이드 창의 왼쪽 메뉴에서 **개요**를 클릭하고 오른쪽에 **공용 IP 주소**의 IP로 SSH 접속을 시도한다.